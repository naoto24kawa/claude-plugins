---
name: reviewing-aws-architecture
description: AWS Well-Architected Frameworkの6つの柱（運用の優秀性、セキュリティ、信頼性、パフォーマンス効率、コスト最適化、持続可能性）に基づいてAWSアーキテクチャをレビュー・評価し、ベストプラクティス適用の具体的改善提案を行う。「アーキテクチャレビュー」「Well-Architected」「セキュリティ評価」「コスト最適化」「可用性改善」「パフォーマンス評価」「持続可能性」などの依頼時に使用
---

## AWSアーキテクチャレビュースキル

このスキルは、AWS Well-Architected Frameworkに基づいて、既存または計画中のAWSアーキテクチャを多角的にレビューし、ベストプラクティスに沿った改善提案を行います。公式ドキュメントと `awslabs:aws-documentation-mcp-server` を活用し、最新のAWS推奨事項に基づいた評価を実施します。

## 使用例

### 例1: 既存システムのセキュリティレビュー

```
状況: EC2 + RDS で構築された既存システムのセキュリティ評価が必要
要求: セキュリティベストプラクティスに基づく評価と改善提案
期待: 具体的なセキュリティリスクの特定、IAM ポリシー改善案、ネットワーク設計の最適化提案
```

### 例2: コスト最適化レビュー

```
状況: 月額AWSコストが予算を超過、無駄なリソースの特定が必要
要求: コスト構造の分析と最適化提案
期待: リザーブドインスタンス推奨、S3 ストレージクラス最適化、Auto Scaling 改善案
```

### 例3: マルチリージョン構成の可用性評価

```
状況: グローバルサービスのDR戦略設計
要求: Well-Architected の信頼性の柱に基づく評価
期待: RTO/RPO 目標に基づくDR戦略、フェイルオーバー手順、データレプリケーション設計
```

## AWS Well-Architected Framework の6つの柱

このスキルは、以下の6つの柱に基づいてアーキテクチャを評価します。各柱の詳細は `./WELL_ARCHITECTED_PILLARS.md` を参照してください。

### 1. 運用の優秀性（Operational Excellence）

**評価観点**:
- 運用手順の自動化
- 頻繁かつ小規模な変更の実施
- 障害からの学習と改善
- モニタリングとログ収集の充実度

**チェック項目**:
- Infrastructure as Code（CloudFormation/CDK）の活用
- CI/CD パイプラインの整備
- CloudWatch Logs、メトリクス、アラームの設定
- AWS Systems Manager による運用管理
- タグ付け戦略の一貫性

### 2. セキュリティ（Security）

**評価観点**:
- 認証・認可の適切性
- データ保護（転送時・保管時の暗号化）
- ネットワーク境界の防御
- セキュリティイベントの検出と対応

**チェック項目**:
- IAM ポリシーの最小権限原則遵守
- VPC 設計（パブリック/プライベートサブネット分離）
- セキュリティグループとNACLの適切性
- AWS WAF、Shield の活用
- GuardDuty、Security Hub、Config の有効化
- データ暗号化（KMS、S3 バケット暗号化、RDS 暗号化）
- Secrets Manager によるシークレット管理

### 3. 信頼性（Reliability）

**評価観点**:
- 障害からの回復能力
- 需要変動への対応
- リソースの適切な分散配置
- バックアップとディザスタリカバリ

**チェック項目**:
- Multi-AZ 構成の採用
- Auto Scaling の設定
- ヘルスチェックとフェイルオーバー
- RDS 自動バックアップ、スナップショット
- S3 バージョニング、クロスリージョンレプリケーション
- Route 53 ヘルスチェックとフェイルオーバー
- サービスクォータとリミットの監視

### 4. パフォーマンス効率（Performance Efficiency）

**評価観点**:
- 適切なリソースタイプとサイズの選択
- グローバルなパフォーマンス最適化
- 技術進化への対応
- リソース使用率のモニタリング

**チェック項目**:
- コンピューティングリソースの適切性（EC2 インスタンスタイプ、Lambda メモリ設定）
- CloudFront、ElastiCache によるキャッシング
- RDS Performance Insights の活用
- X-Ray による分散トレーシング
- データベースインデックス最適化
- Lambda Cold Start 対策

### 5. コスト最適化（Cost Optimization）

**評価観点**:
- 不要なリソースの削減
- 適切な料金モデルの選択
- 使用量の分析と最適化
- コスト配分の透明性

**チェック項目**:
- リザーブドインスタンス、Savings Plans の活用
- Spot インスタンスの活用可能性
- S3 ストレージクラスの最適化（Intelligent-Tiering、Glacier）
- Auto Scaling による需要追従
- Cost Explorer、Budgets、Cost Anomaly Detection の活用
- タグベースのコスト配分
- 未使用リソースの検出（Elastic IP、EBS ボリューム、古いスナップショット）

### 6. 持続可能性（Sustainability）

**評価観点**:
- 環境への影響の最小化
- エネルギー効率の高いリソース選択
- リソース使用率の最大化
- 持続可能性目標の設定と測定

**チェック項目**:
- 再生可能エネルギー比率が高いリージョンの選択
- AWS Graviton プロセッサの活用（ARM ベース、エネルギー効率60%向上）
- リソースの適切なサイジング（過剰プロビジョニング回避）
- S3 Intelligent-Tiering、ライフサイクルポリシーの活用
- 開発/テスト環境の非営業時間停止
- サーバーレスアーキテクチャ（Lambda、Fargate）の活用
- AWS Customer Carbon Footprint Tool での炭素排出量追跡

## レビューワークフロー

### ステップ1: 現状分析とドキュメント収集

**実施内容**:
- アーキテクチャ図の確認または作成
- 使用中のAWSサービス一覧の作成
- 現在の課題と改善目標の整理
- コンプライアンス要件の確認

**収集すべき情報**:
- リソース構成（EC2、RDS、Lambda等の設定）
- ネットワーク構成（VPC、サブネット、セキュリティグループ）
- IAM ロール・ポリシー一覧
- 現在のコスト情報（Cost Explorer データ）
- CloudWatch メトリクス（リソース使用率）
- 過去のインシデント履歴

**検証**:
- アーキテクチャ図が最新かどうか確認
- 未使用リソースの有無を確認

### ステップ2: 各柱の評価

各柱について、チェックリストに基づいて評価を実施します。評価は以下の4段階で行います：

- **Excellent（優秀）**: ベストプラクティスに完全準拠
- **Good（良好）**: 主要な要素は満たしているが、部分的な改善余地あり
- **Fair（普通）**: 基本は満たしているが、重要な改善が必要
- **Poor（不良）**: 重大な問題があり、早急な改善が必要

**評価方法**:
1. チェックリスト（`./CHECKLIST.md`）に基づいて各項目を評価
2. AWS Trusted Advisor の推奨事項を確認
3. AWS Config ルールでコンプライアンス状況を確認
4. `awslabs:aws-documentation-mcp-server:search_documentation` で最新のベストプラクティスを検索
5. `awslabs:aws-documentation-mcp-server:read_documentation` で詳細を確認

### ステップ3: リスク評価と優先度付け

検出された問題を以下の基準で優先度付け：

**優先度分類**:

| 優先度 | 基準 | 対応期限 |
|--------|------|---------|
| 🔴 Critical | セキュリティリスク、サービス停止リスク、コンプライアンス違反 | 即時 |
| 🟠 High | 可用性低下、パフォーマンス問題、重大なコスト浪費 | 1週間以内 |
| 🟡 Medium | 運用効率低下、軽微なセキュリティ問題、中程度のコスト最適化 | 1ヶ月以内 |
| 🟢 Low | 将来的な改善、マイナーな最適化、技術的負債削減 | 3ヶ月以内 |

**リスク評価基準**:
- **影響度**: ビジネスへの影響（大/中/小）
- **発生確率**: 問題発生の可能性（高/中/低）
- **検出容易性**: 問題の検出難易度（困難/普通/容易）

### ステップ4: 改善提案の策定

各問題に対して、以下の内容を含む改善提案を作成：

**提案内容**:

1. **現状の問題点**
   - 何が問題なのか（具体的な設定、構成、実装）
   - なぜ問題なのか（ベストプラクティスとの乖離）
   - リスクの詳細（セキュリティリスク、コスト、パフォーマンス等）

2. **改善案**
   - 具体的な変更内容（設定変更、リソース追加等）
   - 実装方法（AWS CLI コマンド、CloudFormation/CDK コード）
   - Before/After の比較

3. **効果とメリット**
   - セキュリティ向上、コスト削減、パフォーマンス改善等
   - 定量的な効果（可能な場合）

4. **実装難易度と工数**
   - 難易度（簡単/普通/困難）
   - 想定工数（XS: 1時間未満 / S: 1-4時間 / M: 1-2日 / L: 3-5日 / XL: 1週間以上）
   - 必要なスキルセット

5. **リスクと注意点**
   - 変更によるダウンタイムの有無
   - ロールバック手順
   - 依存関係の影響

### ステップ5: アクションプランの作成

優先度と実装難易度に基づいて、段階的な実装計画を策定：

**Phase 1（即時対応）**: 1-2週間
- Critical 優先度の問題を解決
- ダウンタイム不要な変更を優先

**Phase 2（短期改善）**: 1ヶ月
- High 優先度の問題を解決
- 計画的なダウンタイムが必要な変更

**Phase 3（中期改善）**: 3ヶ月
- Medium 優先度の問題を解決
- アーキテクチャの部分的な再設計

**Phase 4（長期改善）**: 6ヶ月
- Low 優先度の問題を解決
- 技術的負債の返済、次世代アーキテクチャへの移行

### ステップ6: レポート作成

レビュー結果を以下の形式でレポートにまとめます：

**レポート構成**:

1. **エグゼクティブサマリー**
   - 総合評価（各柱のスコア）
   - 主要な発見事項（Top 5 Issues）
   - 推奨される優先アクション

2. **詳細評価**
   - 各柱の評価結果（Excellent/Good/Fair/Poor）
   - 具体的な問題点と改善提案
   - Before/After のアーキテクチャ図

3. **優先度付きタスクリスト**
   - Critical / High / Medium / Low 別のタスクリスト
   - 各タスクの工数見積もり

4. **アクションプラン**
   - Phase 1-4 の実装計画
   - マイルストーンと期限

5. **コスト分析**
   - 現在のコスト構造
   - 改善後の予想コスト
   - ROI 分析

## デフォルト設定

ユーザーから特別な指示がない限り、以下のデフォルト設定でレビューを実施します：

### レビュー範囲

| 項目 | デフォルト値 | 説明 |
|------|-------------|------|
| レビュー対象 | 6つの柱すべて | 特定の柱のみのレビューを希望する場合は明示的に指定 |
| 深度 | 標準 | 「詳細レビュー」または「簡易レビュー」の指定可能 |

### 評価基準

| 項目 | デフォルト値 | 説明 |
|------|-------------|------|
| ベンチマーク | AWS Well-Architected Framework | 業界標準に基づく評価 |
| コンプライアンス | 一般的なセキュリティ基準 | 特定の規制要件（HIPAA、PCI DSS等）がある場合は指定 |

### 出力形式

| 項目 | デフォルト値 | 説明 |
|------|-------------|------|
| レポート形式 | Markdown | PDF、PowerPoint 形式も対応可能 |
| 詳細度 | 標準 | 技術的な詳細を含む |
| 図表 | テキストベースの図 | アーキテクチャ図は説明文で提供 |

## チェックリスト

具体的な評価項目のチェックリストは `./CHECKLIST.md` を参照してください。このチェックリストは、以下のカテゴリに分類されています：

- 運用の優秀性チェックリスト（20項目）
- セキュリティチェックリスト（30項目）
- 信頼性チェックリスト（25項目）
- パフォーマンス効率チェックリスト（20項目）
- コスト最適化チェックリスト（25項目）
- 持続可能性チェックリスト（20項目）

## よくあるアンチパターンと改善策

### アンチパターン1: パブリックサブネットにデータベース配置

**問題**:
- RDS インスタンスがパブリックサブネットに配置されている
- インターネットから直接アクセス可能

**改善策**:
- プライベートサブネットに移行
- セキュリティグループでアクセス元を制限
- RDS Proxy を経由した接続

### アンチパターン2: IAM ユーザーのアクセスキー使用

**問題**:
- 長期的なアクセスキーを使用
- キーローテーションが行われていない

**改善策**:
- IAM ロールへの移行
- AWS STS の一時的な認証情報を使用
- Secrets Manager での認証情報管理

### アンチパターン3: シングルAZ構成

**問題**:
- RDS、ECS がシングルAZで構成
- AZ障害時にサービス停止

**改善策**:
- Multi-AZ 構成への移行
- Auto Scaling グループで複数AZ配置
- Route 53 ヘルスチェックとフェイルオーバー

詳細は `./WELL_ARCHITECTED_PILLARS.md` の各柱の説明を参照してください。

## AWS Trusted Advisor との連携

このスキルは、AWS Trusted Advisor の推奨事項を積極的に活用します：

**Trusted Advisor カテゴリ**:
- コスト最適化
- パフォーマンス
- セキュリティ
- 耐障害性
- サービスの制限

**連携方法**:
1. Trusted Advisor の結果を確認
2. 各推奨事項を Well-Architected Framework の柱にマッピング
3. 優先度付けと実装計画への統合

## 継続的な改善

レビューは一度きりではなく、定期的に実施することを推奨します：

**推奨レビューサイクル**:
- **四半期レビュー**: 全体的な評価と優先度更新
- **月次レビュー**: コスト最適化、パフォーマンス確認
- **変更時レビュー**: 大きなアーキテクチャ変更時

**自動化**:
- AWS Config ルールで継続的なコンプライアンス監視
- CloudWatch アラームで問題の早期検出
- EventBridge でセキュリティイベントの自動対応

## 依存関係

このスキルが正常に動作するために必要な依存関係：

### 必須依存関係

- **aws-documentation-mcp-server** (`awslabs:aws-documentation-mcp-server`)
  - Well-Architected Framework、ベストプラクティスの参照に使用
  - 使用するツール:
    - `search_documentation`: ドキュメント検索
    - `read_documentation`: ドキュメント詳細取得

### オプション依存関係

- **AWS CLI**: レビュー自動化スクリプトの実行に必要
  - セキュリティグループ監査
  - 未使用リソース検出
  - コスト分析
  - Well-Architected Tool レビュー
- **jq**: JSON処理に使用（スクリプト実行時）

### 関連スキル

- `developing-aws-solutions`: レビュー後の改善実装
- `researching-aws-documentation`: 詳細なベストプラクティス調査

## 注意事項

1. **ドキュメント参照**: 評価は公式ドキュメントに基づいて行います
2. **カスタマイズ**: 業界固有の要件（HIPAA、PCI DSS等）がある場合は事前に明示してください
3. **実装支援**: レビュー後の実装支援が必要な場合は、`developing-aws-solutions` スキルを使用してください
4. **コスト試算**: 改善提案には概算コストを含めますが、正確な見積もりは AWS Cost Calculator で確認してください

このスキルにより、AWSアーキテクチャを体系的に評価し、ベストプラクティスに基づいた改善を実現できます。
