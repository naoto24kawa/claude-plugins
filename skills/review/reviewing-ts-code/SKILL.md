---
name: reviewing-ts-code
description: 実装コードを6つの専門エージェント（SRP、可読性、KISS、規約、TypeScript、ゴミファイル検出）で多角的にレビューし、トレードオフを考慮した優先度付き改善計画を策定する。「レビュー」「コード品質」「改善提案」「リファクタリング」「設計評価」「型チェック」などの依頼時、または実装後の品質確認が必要な時に使用
---

## コード実装レビューシステム

このコマンドは、実装されたコードを複数の専門エージェントで多角的にレビューし、トレードオフを考慮した現実的な改善計画を策定します。

## 実行方法

対象となるファイルまたはディレクトリを指定して、以下の専門エージェントによるレビューを順次実行し、最終的に統合レポートを作成してください。

## 使用例

### 例 1: 単一ファイルのレビュー

```
対象: src/services/user-service.ts
状況: 新機能実装後の品質確認
期待: 設計上の問題と型安全性の評価
```

### 例 2: ディレクトリ全体のレビュー

```
対象: src/components/
状況: リファクタリング前の現状分析
期待: 技術的負債の特定と優先順位付き改善計画
```

### 例 3: 大規模プロジェクトのレビュー

```
対象: プロジェクトルート（除外: node_modules, dist）
状況: 定期的なコード品質監査
期待: 包括的な品質評価と段階的改善ロードマップ
```

## レビュータスク

### 1. 多角的コードレビューの実施

以下の専門エージェントを並行または順次実行してレビューを収集：

- @agent-review-srp-reviewer による Single Responsibility Principle の評価
- @agent-review-human-code-reviewer による Code for Humans 原則の評価
- @agent-review-kiss-reviewer による KISS 原則（シンプルさ）の評価
- @agent-review-coc-reviewer による Convention over Configuration の評価
- @agent-review-typescript-comprehensive による TypeScript 型安全性の総合評価
- @agent-review-garbage-detector による不要ファイル・ゴミファイルの検出

### 2. レビュー結果の統合と分析

各エージェントのレビュー結果を収集後、トレードオフを考慮した統合分析を実施：

**主な分析観点**:

- SRP vs KISS のバランス
- 可読性 vs パフォーマンス
- 規約統一 vs 互換性維持
- 型厳格性 vs 実装柔軟性

**詳細な分析手法**: `./ANALYSIS_GUIDE.md` を参照

### 3. 統合レポートの作成

全レビュー結果を基に、`./REPORT_TEMPLATE.md` の形式で統合レポートを作成：

**必須セクション**:

- 🔴 Critical / 🟠 High / 🟡 Medium / 🟢 Low の優先度付きタスク
- Phase 1-4 の段階的実装計画
- トレードオフ分析
- リスク評価と軽減策
- 成功指標

**レポートテンプレート**: `./REPORT_TEMPLATE.md` を使用

### 4. 成功指標の定義

改善効果を測定するための指標を設定：

**主要メトリクス**:

- コード品質（複雑度、重複率、カバレッジ）
- 開発効率（機能追加時間、レビュー時間）
- 運用品質（インシデント数、MTTR）
- ビジネス価値（リリース頻度、顧客満足度）

**詳細な指標ガイド**: `./METRICS.md` を参照

## 実行手順（検証付きワークフロー）

### ステップ 1: 対象の指定と準備

- レビュー対象のファイル/ディレクトリを明確に指定
- **検証**: 対象が存在し、アクセス可能であることを確認

### ステップ 2: エージェント実行

- 各専門エージェントを並行または順次実行
  - @agent-review-srp-reviewer
  - @agent-review-human-code-reviewer
  - @agent-review-kiss-reviewer
  - @agent-review-coc-reviewer
  - @agent-review-typescript-comprehensive
  - @agent-review-garbage-detector
- **検証**: すべてのエージェントが正常に完了したか確認
- **エラー時**: 失敗したエージェントのみ再実行、または部分的な結果で続行

### ステップ 3: 結果収集と検証

- 各エージェントのレビュー結果を収集
- **検証**:
  - 各エージェントの出力が有効な形式であることを確認
  - 空の結果や不完全な出力がないか確認
- **エラー時**: 不完全な結果は除外し、取得できた結果のみで分析

### ステップ 4: 統合分析

- トレードオフを考慮した統合分析を実施
- 相反する提案の調整と優先度付け
- **検証**:
  - 相反する提案がリストアップされているか確認
  - 各優先度レベル（Critical/High/Medium/Low）にタスクが分類されているか確認
- **エラー時**: 手動で優先度を調整

### ステップ 5: レポート作成

- 優先度付きタスクリストと実装計画を作成
- REPORT_TEMPLATE.md の形式に従って出力
- **検証**:
  - レポートに必須セクション（優先度別タスク、実装計画、リスク評価）が含まれているか確認
  - 各タスクに工数見積もり（XS/S/M/L/XL）が付与されているか確認
- **出力**: 統合レポートを Markdown 形式で提供

## デフォルト設定

ユーザーから特別な指示がない限り、以下のデフォルト設定で実行：

### 実行方式

- **エージェント実行**: 6 つすべてのエージェントを並行実行
- **失敗時の処理**: エラーが発生した場合、その旨を報告し、取得できた結果のみでレポート生成
- **対象範囲**: ユーザーが指定したファイル/ディレクトリのみ（サブディレクトリは含まない、ただし明示的な指定があれば再帰的に処理）

### 出力形式

- **レポート形式**: Markdown 形式の統合レポート
- **優先度基準**: Critical > High > Medium > Low の 4 段階で評価
- **工数表記**: XS（1 時間未満）/ S（1-4 時間）/ M（1-2 日）/ L（3-5 日）/ XL（1 週間以上）

### 分析基準

- **トレードオフ判断**: セキュリティ > 保守性 > パフォーマンス > コード美観 の優先順位
- **実用性重視**: 理想的な設計より、現実的で実装可能な提案を優先
- **段階的改善**: 一度にすべてを修正するのではなく、Phase 分けで段階的な改善計画を提示

## 注意事項

1. 対象ファイルまたはディレクトリを明確に指定してください
2. プロジェクトの規模と現状を考慮した現実的な提案を行います
3. チームのスキルレベルと利用可能なリソースを考慮します
4. 既存の CI/CD パイプラインとの整合性を確保します
5. ビジネス要求と技術的理想のバランスを取ります

このレビューシステムにより、コードの品質向上と技術的負債の削減を、現実的かつ段階的に進めることができます。
